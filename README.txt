Remarks regarding the code:
- Logic should be moved to services rather than repositories and controllers.
- Extracting logic in services and separating them from queries helps in writing unit tests
- No try catch was used in the code which makes debugging tough and also crashes the server.
- There are a lot of conditions in repositories too, the purpose of repos should only be to make queries (get params and return results from query).
- env data should be pulled from config or constant files
- Request middlewares should be used so that missing params could be validated before code is executed further.
- Early return pattern should be used.
- Instead of repeating if statements, a helper function should be created that returns the desired result.
- Logs should be used through out the project.
- Triggering emails in repositories is not a good practise, It should be moved to services.
- Try to user ternary operators where if-else is needed. (Better readabilty).
- Un-used variables should be deleted.
- Transactions should be used on database operations.